<nav class="absolute top-0 left-0 w-full z-20">
  <input id="mon-drawer" type="checkbox" class="top-drawer-toggle hidden" />
  <div class="flex flex-col">
    <!-- Navbar -->
    <div
      class="navbar bg-transparent w-full flex flex-row-reverse md:flex-row md:px-14 pt-8 pr-8"
    >
      <div class="flex-none lg:hidden">
        <label
          for="mon-drawer"
          aria-label="open sidebar"
          class="btn btn-square btn-ghost gradient-border"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            class="inline-block h-6 w-6 stroke-white"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </label>
      </div>

      <!-- Logo pour desktop (visible sur toutes les pages) -->
      <a href="/" class="mx-2 px-2 flex-1 hidden lg:block">
        <img src="/assets/logo.svg" alt="CP Academy" class="w-30 h-30" />
      </a>

      <!-- Logo pour mobile (visible sur toutes les pages sauf home) -->
      <a href="/" class="mx-2 px-2 flex-1 lg:hidden" id="mobile-logo">
        <img src="/assets/logo.svg" alt="CP Academy" class="w-16 h-16" />
      </a>

      <div class="hidden flex-none lg:block">
        <ul class="menu menu-horizontal gap-8 text-white font-bold">
          <!-- Navbar menu content here -->
          <li><a href="/">Accueil</a></li>
          <li class="dropdown-menu hover:bg-black/20">
            <details>
              <summary class="font-semibold text-white">Nos formations</summary>
              <ul
                class="rounded-t-none bg-black/90 w-80 rounded-b-xl space-y-3 shadow-lg"
              >
                <li class="dropdown-submenu">
                  <details>
                    <summary class="text-sm font-semibold text-white/90"
                      >Création / Développement d'entreprise &amp; Techniques
                      professionnelles</summary
                    >
                    <ul
                      class="menu menu-compact gap-3 pl-4 text-xs text-white/90"
                    >
                      <li>
                        <a class="py-2 text-sm" href="/browlift"
                          >Browlift &amp; Rehaussement de cils</a
                        >
                      </li>
                      <li>
                        <a class="py-2 text-sm" href="/botox"
                          >Soin capillaire au Botox</a
                        >
                      </li>
                      <li>
                        <a class="py-2 text-sm" href="/prothesiste"
                          >Prothésiste ongulaire</a
                        >
                      </li>
                    </ul>
                  </details>
                </li>
                <li>
                  <a class="py-2 text-sm" href="/relation-client"
                    >Relation et expérience client</a
                  >
                </li>
                <li class="pl-3 text-gray-300/70 cursor-not-allowed">
                  Suivi et Satisfaction client (à venir)
                </li>
              </ul>
            </details>
          </li>
          <li><a href="/about">CP Academy</a></li>
        </ul>
      </div>
    </div>

    <!-- Menu déroulant du haut -->
    <div class="top-drawer">
      <div class="top-drawer-overlay"></div>
      <div
        class="top-drawer-content bg-white bg-cover bg-center w-full h-screen p-8"
      >
        <header class="flex flex-row-reverse">
          <label
            for="mon-drawer"
            class="btn btn-square btn-ghost gradient-border-white gradient-border group"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-6 w-6 stroke-black transition-colors group-hover:stroke-white"
              fill="none"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </label>
        </header>
        <div class="flex flex-col items-center justify-center h-full">
          <ul class="menu menu-vertical gap-8 text-2xl">
            <li><a href="/">Accueil</a></li>
            <li class="dropdown-mobile">
              <details>
                <summary>Nos formations</summary>
                <ul class="menu menu-vertical gap-6 text-2xl">
                  <li class="dropdown-submenu pl-0">
                    <details>
                      <summary class="text-sm"
                        >Création / Développement d'entreprise &amp; Techniques
                        professionnelles</summary
                      >
                      <ul class="menu menu-vertical gap-4 pl-4 text-xl">
                        <li class="mt-4">
                          <a class="py-2 text-sm" href="/browlift"
                            >Browlift &amp; Rehaussement de cils</a
                          >
                        </li>
                        <li>
                          <a class="py-2 text-sm" href="/botox"
                            >Soin capillaire au Botox</a
                          >
                        </li>
                        <li>
                          <a class="py-2 text-sm" href="/prothesiste"
                            >Prothésiste ongulaire</a
                          >
                        </li>
                      </ul>
                    </details>
                  </li>
                  <li>
                    <a class="py-2 text-sm" href="/relation-client"
                      >Relation et expérience client</a
                    >
                  </li>
                  <li class="pl-3 text-sm text-gray-300/90 cursor-not-allowed">
                    Suivi et Satisfaction client (à venir)
                  </li>
                </ul>
              </details>
            </li>
            <li><a href="/about">CP Academy</a></li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Page content here -->
  </div>
</nav>

<script>
  // Vérifier si on est sur la page d'accueil
  const isHomePage =
    window.location.pathname === "/" ||
    window.location.pathname === "/index.html";
  const mobileLogo = document.getElementById("mobile-logo");

  // Cacher le logo mobile si on est sur la page d'accueil
  if (isHomePage && mobileLogo) {
    mobileLogo.style.display = "none";
  }

  // Fix pour le dropdown en production - s'assurer que les clics fonctionnent
  document.addEventListener('DOMContentLoaded', () => {
    const dropdownDetails = document.querySelectorAll('.dropdown-menu details');
    
    dropdownDetails.forEach((details) => {
      const summary = details.querySelector('summary');
      if (summary) {
        // Force le comportement natif même en production
        summary.addEventListener('click', (e) => {
          // Laisse le comportement natif se produire
          setTimeout(() => {
            // S'assure que le menu est bien positionné
            const ul = details.querySelector('ul');
            if (ul && details.hasAttribute('open')) {
              ul.style.display = 'block';
            }
          }, 0);
        });
      }
    });

    // Ferme le dropdown quand on clique ailleurs
    document.addEventListener('click', (e) => {
      dropdownDetails.forEach((details) => {
        if (!details.contains(e.target as Node) && details.hasAttribute('open')) {
          details.removeAttribute('open');
        }
      });
    });
  });
</script>

<style>
  li > a:hover {
    background: linear-gradient(
      90deg,
      rgba(65, 88, 208, 1) 0%,
      rgba(199, 81, 192, 1) 50%,
      rgba(255, 203, 112, 1) 100%
    );
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }
  .gradient-border {
    position: relative;
    z-index: 0;
    background: transparent;
  }

  .gradient-border::before {
    content: "";
    position: absolute;
    z-index: -1;
    inset: -2px;
    border-top-right-radius: 0.5rem;
    border-bottom-left-radius: 0.5rem;
    background: linear-gradient(45deg, #4158d0, #c751c0, #ffcb70);
    padding: 2px;
  }

  .gradient-border::after {
    content: "";
    position: absolute;
    z-index: -1;
    inset: 0;
    border-top-right-radius: 0.4rem;
    border-bottom-left-radius: 0.4rem;
    background-color: var(--background-color, #20201f);
    transition: background-color 0.3s ease;
  }

  .gradient-border-white::after {
    content: "";
    position: absolute;
    z-index: -1;
    inset: 0;
    border-top-right-radius: 0.4rem;
    border-bottom-left-radius: 0.4rem;
    background-color: var(--background-color, white);
    transition: background-color 0.3s ease;
  }

  .gradient-border:hover::after {
    background-color: transparent;
  }

  /* Styles pour le menu plein écran */
  .top-drawer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 0;
    overflow: hidden;
    transition: height 0.5s ease-in-out;
    z-index: 50;
  }

  .top-drawer-toggle:checked ~ div .top-drawer {
    height: 100vh;
  }

  .top-drawer-content {
    opacity: 0;
    transform: translateY(-50px);
    transition:
      opacity 0.5s,
      transform 0.5s;
    transition-delay: 0.1s;
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .top-drawer-toggle:checked ~ div .top-drawer .top-drawer-content {
    opacity: 1;
    transform: translateY(0);
  }

  .top-drawer-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
    z-index: -1;
  }

  .top-drawer-toggle:checked ~ div .top-drawer-overlay {
    opacity: 1;
    pointer-events: auto;
  }

  .dropdown-menu details[open] {
    position: relative;
    background-color: transparent;
    border-radius: 0.5rem;
  }

  .dropdown-menu details[open]::before {
    content: "";
    position: absolute;
    inset: -1px;
    border-radius: 0.5rem;
    background: linear-gradient(
      90deg,
      rgba(65, 88, 208, 1) 0%,
      rgba(199, 81, 192, 1) 50%,
      rgba(255, 203, 112, 1) 100%
    );
    z-index: -1;
    pointer-events: none !important;
  }

  .dropdown-menu details[open]::after {
    content: "";
    position: absolute;
    inset: 1px;
    border-radius: 0.4rem;
    background-color: #20201f;
    z-index: -1;
    pointer-events: none !important;
  }

  .dropdown-menu details[open] summary {
    background-color: transparent;
  }

  .dropdown-menu details[open] ul {
    background-color: #121212;
    margin-top: 0.5rem;
    border-radius: 0.5rem;
    padding: 0.5rem;
  }

  .dropdown-menu details[open] summary:hover,
  .dropdown-menu details[open] ul li a:hover {
    background: linear-gradient(
      90deg,
      rgba(65, 88, 208, 1) 0%,
      rgba(199, 81, 192, 1) 50%,
      rgba(255, 203, 112, 1) 100%
    );
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    background-color: transparent;
  }

  .dropdown-menu details[open] ul li a:hover {
    background-color: transparent;
  }

  .dropdown-menu summary:hover,
  .dropdown-menu ul li a:hover {
    background: linear-gradient(
      90deg,
      rgba(65, 88, 208, 1) 0%,
      rgba(199, 81, 192, 1) 50%,
      rgba(255, 203, 112, 1) 100%
    );
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    background-color: transparent;
  }

  .dropdown-menu ul li a:hover {
    background-color: transparent;
  }

  /* Styles pour le dropdown mobile */
  .dropdown-mobile details {
    color: black;
    width: 100%;
  }

  .dropdown-mobile summary {
    cursor: pointer;
    list-style: none;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.7rem;
    width: 100%;
    padding-right: 1.5rem;
    min-height: 2rem;
  }

  .dropdown-mobile summary::after {
    flex-shrink: 0;
    width: 0.5rem;
    height: 0.5rem;
  }

  .dropdown-mobile details[open] {
    position: static;
  }

  .dropdown-mobile details[open] ul {
    animation: slideDown 0.2s ease-out;
    position: static;
    width: 100%;
  }

  /* Container principal du menu */
  .flex-col.items-center.justify-center.h-full {
    display: flex;
    width: 100%;
    height: 80%;
    justify-content: center;
    align-items: center;
    overflow: auto;
  }

  .menu.menu-vertical {
    width: 100%;
    max-width: 250px;
    margin: 0 auto;
  }

  /* Reset des alignements pour conserver les textes à gauche */
  .menu.menu-vertical li a {
    justify-content: flex-start;
    padding-left: 16px;
  }

  /* Style pour le dropdown mobile */
  .dropdown-mobile summary {
    justify-content: flex-start;
    text-align: left;
    padding-left: 16px;
  }

  /* Conserver l'alignement à gauche dans le dropdown */
  .dropdown-mobile details[open] ul {
    animation: slideDown 0.2s ease-out;
    width: 100%;
    padding-left: 16px;
  }

  .dropdown-mobile details[open] ul li {
    width: 100%;
  }

  .dropdown-mobile details[open] ul li a {
    justify-content: flex-start;
    width: 100%;
    text-align: left;
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
